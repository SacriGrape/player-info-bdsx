"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const htmlutil_1 = require("./htmlutil");
const styling_1 = require("./styling");
const type_1 = require("./type");
const writer_1 = require("./writer");
const DOCURL_SCRIPTING = 'https://bedrock.dev/docs/stable/Scripting';
const DOCURL_ADDONS = 'https://bedrock.dev/docs/stable/Addons';
const OUT_SCRIPTING = path.join(__dirname, '../generated.scripting.ts');
const OUT_ADDONS = path.join(__dirname, '../generated.addons.ts');
const docfixRaw = require('./docfix.json');
const docfix = new Map();
for (const name in docfixRaw) {
    const item = docfixRaw[name];
    docfix.set(name, type_1.DocType.fromDocFix(item));
}
const BINDING_SUFFIX = ' Bindings';
const COMPONENT_SUFFIX = ' Components';
const EVENT_SUFFIX = ' Events';
const system = new type_1.DocType;
const compMap = new type_1.DocType;
const listenerEvents = new type_1.DocType;
const triggerEvents = new type_1.DocType;
async function printInterface(writer, iname, s) {
    let type = null;
    try {
        type = type_1.DocType.fromTable(s.searchTableAsObject());
    }
    finally {
        const docfixItem = docfix.get(iname);
        if (docfixItem) {
            if (type)
                type.patch(docfixItem);
            else
                type = docfixItem;
        }
        if (type === null) {
            type = type_1.DocType.inline('any');
            type.desc = 'Not documented';
        }
        await type.writeTo(iname, writer);
    }
}
async function printComponent(writer, id, postfix, s) {
    const ns = id.indexOf(':');
    if (ns === -1) {
        console.error(`   └ ${id}: Component without colon`);
        return '';
    }
    const name = 'I' + styling_1.styling.toCamelStyle(id.substr(ns + 1), '_', true) + postfix;
    console.log(`   └ ${id}: ${name}`);
    await printInterface(writer, name, s);
    return name;
}
async function parseScriptingDoc() {
    console.log('# Parse Scripting Document');
    const base = await htmlutil_1.htmlutil.wgetElement(DOCURL_SCRIPTING, 'html', 'body', 'div', 'div', 'div', 'div', 'div', 'div');
    if (base === null) {
        console.error(`Scripting: Target element not found`);
        return;
    }
    const writer = new writer_1.FileWriter(OUT_SCRIPTING);
    await writer.write(`/**\n * Generated with bdsx/bds-scripting/parser.ts\n * docfix.json overrides it.\n * Please DO NOT modify this directly.\n */\ndeclare global {\n\n`);
    try {
        const s = new htmlutil_1.HtmlSearcher(base);
        await s.minecraftDocHeader('Item', 'h1', async (node, id) => {
            console.log(id);
            const iname = styling_1.styling.apiObjectNameToInterfaceName(id);
            if (iname !== null) {
                if (iname === 'IBlock') { // doc bug, wrong <p> tag
                    const p = s.nextIf('p');
                    if (p) {
                        const table = htmlutil_1.htmlutil.firstChild(p);
                        if (table && table.tagName === 'TABLE') {
                            s.enter(p);
                        }
                    }
                }
                console.log(' └ interface ' + iname);
                await printInterface(writer, iname, s);
                if (iname === 'ILevelTickingArea') {
                    s.leave();
                }
            }
            else if (id.endsWith(BINDING_SUFFIX) || id === 'Entity Queries' || id === 'Slash Commands') {
                await s.minecraftDocHeader('Function', 'h2', async (node, id) => {
                    console.log(' └ ' + id);
                    const p = s.nextIf('p');
                    const desc = p !== null ? p.innerText : '';
                    const funcidx = id.indexOf('(');
                    if (funcidx !== -1) {
                        const funcloseidx = id.lastIndexOf(')');
                        const funcname = id.substr(0, funcidx).trim();
                        const paramNameMap = new Map();
                        const paramNames = id.substring(funcidx + 1, funcloseidx).split(',');
                        for (let i = 0; i < paramNames.length; i++) {
                            paramNameMap.set(paramNames[i].trim(), i);
                        }
                        const method = new type_1.DocMethod(funcname);
                        method.desc = desc;
                        system.methods.push(method);
                        const docfixItem = docfix.get('IVanillaServerSystem').getMethod(funcname);
                        if (docfixItem !== null && docfixItem.deleted)
                            return;
                        try {
                            await s.each('Types', node => {
                                if (node.innerHTML === 'Parameters')
                                    return true; // doc bug, 'addFilterToQuery' has not anchor
                                return htmlutil_1.htmlutil.checks(node, { tag: 'h3', class: 'anchored-heading' }, { tag: 'span', class: 'anchor' });
                            }, node => {
                                const span = htmlutil_1.htmlutil.follow(node, 'span');
                                const id = span !== null ? span.id : node.innerHTML;
                                switch (id) {
                                    case 'Parameters': {
                                        const structure = type_1.DocType.fromTable(s.searchTableAsObject());
                                        const fields = structure.fields;
                                        const nfields = [];
                                        for (const field of fields) {
                                            const fieldIndex = paramNameMap.get(field.name);
                                            if (fieldIndex === undefined) {
                                                console.error(`param name not found: ${field.name}`);
                                                continue;
                                            }
                                            nfields[fieldIndex] = field;
                                        }
                                        method.params.push(...nfields.filter(v => v));
                                        method.setCamel();
                                        break;
                                    }
                                    case 'Return Value': {
                                        const structure = type_1.DocType.fromTable(s.searchTableAsObject());
                                        if (structure.fields.length !== 0) {
                                            method.return = structure.fields[0].type;
                                        }
                                        break;
                                    }
                                }
                            });
                        }
                        finally {
                            if (docfixItem !== null)
                                method.patch(docfixItem);
                        }
                    }
                });
            }
            else if (id.endsWith(COMPONENT_SUFFIX)) {
                if (id === 'Client Components')
                    return;
                await s.minecraftDocHeader('Components', 'h2', async (node, id) => {
                    const name = await printComponent(writer, id, 'Component', s);
                    if (name) {
                        compMap.fields.push(new type_1.DocField(id, type_1.DocType.inline(`IComponent<${name}>`)));
                    }
                });
            }
            else if (id.endsWith(EVENT_SUFFIX)) {
                if (id === 'Client Events')
                    return;
                await s.minecraftDocHeader('Types', 'h2', async (node, id) => {
                    console.log(' └ ' + id);
                    switch (id) {
                        case 'Listening Events':
                            await s.minecraftDocHeader('Events', 'h3', async (node, id) => {
                                const name = await printComponent(writer, id, 'EventData', s);
                                if (name) {
                                    listenerEvents.fields.push(new type_1.DocField(id, type_1.DocType.inline(`IEventData<${name}>`)));
                                }
                            });
                            break;
                        case 'Trigger-able Events':
                            await s.minecraftDocHeader('Events', 'h3', async (node, id) => {
                                const name = await printComponent(writer, id, 'Parameters', s);
                                if (name) {
                                    triggerEvents.fields.push(new type_1.DocField(id, type_1.DocType.inline(`IEventData<${name}>`)));
                                }
                            });
                            break;
                    }
                });
            }
        });
    }
    catch (err) {
        if (err === htmlutil_1.HtmlSearcher.EOF)
            return;
        console.error(err.stack || err);
    }
    finally {
        await compMap.writeTo('MinecraftComponentNameMap', writer);
        await triggerEvents.writeTo('MinecraftServerEventNameMap', writer);
        await listenerEvents.writeTo('MinecraftClientEventNameMap', writer);
        system.patch(docfix.get('IVanillaServerSystem'));
        await system.writeTo('IVanillaServerSystem', writer);
        await writer.write('}\nexport {};\n');
        await writer.end();
    }
}
async function parseAddonsDoc() {
    console.log('# Parse Addons Document');
    const base = await htmlutil_1.htmlutil.wgetElement(DOCURL_ADDONS, 'html', 'body', 'div', 'div', 'div', 'div', 'div', 'div');
    if (base === null) {
        console.error(`Addons: Target element not found`);
        return;
    }
    const s = new htmlutil_1.HtmlSearcher(base);
    let blockParsed = false;
    const writer = new writer_1.FileWriter(OUT_ADDONS);
    await writer.write(`/**\n * Generated with bdsx/bds-scripting/parser.ts\n * Please DO NOT modify this directly.\n */\n`);
    await writer.write(`declare global {\n\n`);
    try {
        await s.minecraftDocHeader('Blocks', 'h1', async (node, id) => {
            console.log(id);
            switch (id) {
                case 'Blocks':
                    if (blockParsed)
                        break;
                    blockParsed = true;
                    await type_1.DocType.writeTableKeyUnion('BlockId', 'minecraft:', s.searchTableAsObject(), 'Name', v => v, writer);
                    break;
                case 'Entities': {
                    const table = s.searchTableAsObject();
                    await type_1.DocType.writeTableKeyUnion('EntityId', '', table, 'Identifier', v => 'minecraft:' + v, writer);
                    // await DocType.writeTableKeyUnion('EntityFullId', '', table, 'Identifier', row=>row.FullID.text, writer);
                    // await DocType.writeTableKeyUnion('EntityShortId', '', table, 'Identifier', row=>row.ShortID.text, writer);
                    break;
                }
                case 'Items': {
                    const table = s.searchTableAsObject();
                    await type_1.DocType.writeTableKeyUnion('ItemId', '', table, 'Name', name => {
                        if (name.startsWith('item.'))
                            return null;
                        return 'minecraft:' + name;
                    }, writer);
                    // await DocType.writeTableKeyUnion('ItemNumberId', '', table, 'Name', row=>row['ID'].text, writer);
                    break;
                }
                case 'Entity Damage Source': {
                    await type_1.DocType.writeTableKeyUnion('MinecraftDamageSource', '', s.searchTableAsObject(), 'DamageSource', v => v, writer);
                    break;
                }
            }
        });
    }
    catch (err) {
        if (err === htmlutil_1.HtmlSearcher.EOF)
            return;
        console.error(err.stack || err);
    }
    finally {
        await writer.write('}\n');
        await writer.write('export {};\n');
        await writer.end();
    }
}
(async () => {
    await parseScriptingDoc();
    await parseAddonsDoc();
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsicGFyc2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsNkJBQThCO0FBQzlCLHlDQUFvRDtBQUNwRCx1Q0FBb0M7QUFDcEMsaUNBQTZFO0FBQzdFLHFDQUFzQztBQUV0QyxNQUFNLGdCQUFnQixHQUFHLDJDQUEyQyxDQUFDO0FBQ3JFLE1BQU0sYUFBYSxHQUFHLHdDQUF3QyxDQUFDO0FBRS9ELE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLDJCQUEyQixDQUFDLENBQUM7QUFDeEUsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsd0JBQXdCLENBQUMsQ0FBQztBQUVsRSxNQUFNLFNBQVMsR0FBRyxPQUFPLENBQUMsZUFBZSxDQUEyQyxDQUFDO0FBQ3JGLE1BQU0sTUFBTSxHQUFHLElBQUksR0FBRyxFQUFtQixDQUFDO0FBQzFDLEtBQUssTUFBTSxJQUFJLElBQUksU0FBUyxFQUFFO0lBQzFCLE1BQU0sSUFBSSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM3QixNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxjQUFPLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Q0FDOUM7QUFJRCxNQUFNLGNBQWMsR0FBRyxXQUFXLENBQUM7QUFDbkMsTUFBTSxnQkFBZ0IsR0FBRyxhQUFhLENBQUM7QUFDdkMsTUFBTSxZQUFZLEdBQUcsU0FBUyxDQUFDO0FBRS9CLE1BQU0sTUFBTSxHQUFHLElBQUksY0FBTyxDQUFDO0FBQzNCLE1BQU0sT0FBTyxHQUFHLElBQUksY0FBTyxDQUFDO0FBQzVCLE1BQU0sY0FBYyxHQUFHLElBQUksY0FBTyxDQUFDO0FBQ25DLE1BQU0sYUFBYSxHQUFHLElBQUksY0FBTyxDQUFDO0FBRWxDLEtBQUssVUFBVSxjQUFjLENBQUMsTUFBaUIsRUFBRSxLQUFZLEVB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